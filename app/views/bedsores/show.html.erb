<%= javascript_include_tag "library/atrament.min" %>
<%= javascript_include_tag "paint" %>

<h1><%= @bedsore.bedsore_part.patient.name %>さんの<%= @bedsore.bedsore_part.part_name %>のDESIGN-R</h1>
<%= link_to("#{@bedsore.bedsore_part.patient.name}さんの個人ページへ", "/patients/#{@bedsore.bedsore_part.patient.id}") %>
<p>(撮影者:<%= @bedsore.image_editor.name %> <%= @bedsore.image_edited_at %></p>
<p>褥瘡評価:</p>
<%= form_with model: @bedsore.design_r, local: true do |form| %>
  <%= render :partial => 'design_r_form', :locals => {:form => form} %>
<% end %>
<h3>褥瘡画像</h3>

<div>
  <div>
    <div class="form-row">
      <div class="form-group col-md-1">
        <button class="btn btn-primary btn-sm" id="save_canvas">保存</button>
      </div>
      <div class="form-group col-md-1">
        <button class="btn btn-danger btn-sm" id="clear_canvas">消去</button>
      </div>
    </div>
    <div class="form-row">
      <div class="form-group col-md-2">
        <label for="color_canvas">ペンの色</label>
        <select id="color_canvas" class="custom-select custom-select-lg mb-3">
          <option value="000000">黒</option>
          <option value="0000ff">青</option>
          <option value="008000">緑</option>
          <option value="ff0000">赤</option>
        </select>
      </div>
      <div class="form-group col-md-2">
        <label for="color_canvas">モード</label>
        <select id="mode_canvas" class="custom-select custom-select-lg mb-3">
          <option value="draw">ペン</option>
          <option value="fill">塗りつぶし</option>
          <option value="erase">消しゴム</option>
        </select>
      </div>
      <div class="form-group col-md-6">
        <label for="weight_canvas">太さ</label>
        <input type="range" class="custom-range" min="1" max="20" value="5" id="weight_canvas">
      </div>
    </div>
  <div>

  <div style="position: relative;">
    <canvas class="" id="mySketcher" style="position: absolute; z-index:50;"></canvas>
    <%= image_tag(@bedsore.image.url, :class => "img-fluid",:id=> "under_image", :style => "position: absolute; z-index:1;") if @bedsore.image?%>
  </div>

  <%= form_for(@bedsore) do |form| %>
    <%= form.hidden_field :remote_handwrite_image_url %>
    <%= form.hidden_field :handwrite_image %>
  <% end %>

</div>